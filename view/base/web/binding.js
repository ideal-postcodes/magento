/**
 * @license
 * Ideal Postcodes <https://ideal-postcodes.co.uk>
 * Magento Integration
 * Copyright IDDQD Limited, all rights reserved
 */
!function(){"use strict";function n(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function e(e,t){return function(n){if(Array.isArray(n))return n}(e)||function(n,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n)){var t=[],r=!0,o=!1,i=void 0;try{for(var u,c=n[Symbol.iterator]();!(r=(u=c.next()).done)&&(t.push(u.value),!e||t.length!==e);r=!0);}catch(n){o=!0,i=n}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return t}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var r,o=function(n,e){return n.dispatchEvent(function(n){var e=n.event,t=n.bubbles,r=void 0===t||t,o=n.cancelable,i=void 0===o||o;if("function"==typeof window.Event)return new window.Event(e,{bubbles:r,cancelable:i});var u=document.createEvent("Event");return u.initEvent(e,r,i),u}({event:e}))},i=function(n){return null!==n&&n instanceof HTMLSelectElement},u=function(n){return null!==n&&n instanceof HTMLInputElement},c=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n&&u(n)&&d({e:n,value:e,skipTrigger:t})},a=function(n,e){return null!==e&&null!==n.querySelector('[value="'.concat(e,'"]'))},l=function(n,e){n.value=e,n.value!==e&&s(n,e)},s=function(n,e){var t=Object.getOwnPropertyDescriptor(n.constructor.prototype,"value");void 0!==t&&(void 0!==t.set&&t.set.call(n,e))},d=function(n){var e,t,r,c;null!==n.value&&(t=(e=n).e,r=e.value,c=e.skipTrigger,null!==r&&i(t)&&(l(t,r),c||o(t,"select"),o(t,"change")),function(n){var e=n.e,t=n.value,r=n.skipTrigger;null!==t&&u(e)&&(l(e,t),r||o(e,"input"),o(e,"change"))}(n))},f=function(n){return/^GY/.test(n.postcode)?"GG":/^JE/.test(n.postcode)?"JE":null},p="United Kingdom",v="Isle of Man",y="England",m="Scotland",g="Wales",w="Northern Ireland",b="Channel Islands",h=function(n){var e=n.country;if(e===y)return p;if(e===m)return p;if(e===g)return p;if(e===w)return p;if(e===v)return v;if(e===b){var t=f(n);if("GG"===t)return"Guernsey";if("JE"===t)return"Jersey"}return null},_=function(n,e){if(n){if(i(n)){var t=function(n){var e=n.country;return e===y||e===m||e===g||e===w?"GB":e===v?"IM":e===b?f(n):null}(e);a(n,t)&&d({e:n,value:t});var r=h(e);a(n,r)&&d({e:n,value:r})}if(u(n)){var o=h(e);d({e:n,value:o})}}},j=function(){return!0},E=function(n,e){for(var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j,r=n,o=e.toUpperCase();"HTML"!==r.tagName;){if(r.tagName===o&&t(r))return r;if(null===r.parentNode)return null;r=r.parentNode}return null},O=function(n,e){return e?n.querySelector(e):null},S=function(n,e){var t,r=(e||window.document).querySelectorAll(n),o=(t=r,Array.prototype.slice.call(t)).filter((function(n){return!("true"===n.getAttribute("idpc"))}));return 0===o.length?[]:(o.forEach((function(n){return n.setAttribute("idpc","true")})),o)},k=function(n){var e=n.elem,t=n.target,r=t.parentNode;if(null!==r)return r.insertBefore(e,t),e},L=function(n){return void 0!==n.IdealPostcodes&&(void 0!==n.IdealPostcodes.Autocomplete&&void 0!==n.IdealPostcodes.Autocomplete.Controller)},T=function(n){return!0!==n.autocomplete||L(window)?"complete":(function(n){if(void 0!==r)return r;var e=n||window.document;r=q("https://cdn.jsdelivr.net/npm/ideal-postcodes-autocomplete@0.2.1/css/ideal-postcodes-autocomplete.css",e),e.head.appendChild(r)}(),M(),"loading")},I=function(n){return void 0!==n.jQuery},P=function(n){return!1!==I(n)&&void 0!==n.jQuery.prototype.setupPostcodeLookup},A=function(n){return!0!==n.postcodeLookup||P(window)?"complete":(B(),I(window)&&N(),"loading")},G={},C=function(n,e){return function(t){if(G[n])return G[n];var r=t||window.document,o=K(n,e,r);return r.head.appendChild(o),G[n]=o,o}},B=C("https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js","sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="),N=C("https://cdn.jsdelivr.net/npm/jquery-postcodes@3.0.8/dist/postcodes.min.js","sha256-JZSN3ZEXOFlpSMFjQkHjbKnjHlsFVf8N7p1SbCI0XHI="),M=C("https://cdn.jsdelivr.net/npm/ideal-postcodes-autocomplete@0.2.1/dist/ideal-postcodes-autocomplete.min.js","sha256-lZPaPHBx7V2Gj9iAc8QfVcW02KlWB2gbrqXpGfiEGgo="),q=function(n,e){var t=e.createElement("link");return t.type="text/css",t.rel="stylesheet",t.href=n,t},K=function(n,e,t){var r=t.createElement("script");return r.type="text/javascript",r.crossOrigin="anonymous",r.integrity=e,r.src=n,r};function x(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function H(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){t(n,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}))}return n}var J={enabled:!0,apiKey:"",populateOrganisation:!0,populateCounty:!1,autocomplete:!0,autocompleteOverride:{},postcodeLookup:!0,postcodeLookupOverride:{}},D=function(){var n=window.idpcConfig;if(void 0!==n)return H(H({},J),n)},F=function(n){return n.filter((function(n){return"string"==typeof n?!!n.trim():!!n})).join(", ")},Q=function(n,t){var r=e(function(n,e){var t=e.line_1,r=e.line_2,o=e.line_3;return 3===n?[t,r,o]:2===n?[t,F([r,o]),""]:[F([t,r,o]),"",""]}(function(n){var e=n.line_2,t=n.line_3;return e?t?3:2:1}(n),t),3),o=r[0],i=r[1],u=r[2];c(n.line_1,o,!0),c(n.line_2,i),c(n.line_3,u)},U=function(n){var e=n.targets,t=n.config;return function(n){Q(e,n),c(e.post_town,n.post_town),c(e.postcode,n.postcode),_(e.country,n),t.populateOrganisation&&c(e.organisation,n.organisation_name),t.populateCounty&&c(e.county,n.county)}},V=function(n){var e=n.pageTest,t=n.bind,r=null,o=function(){null!==r&&(window.clearInterval(r),r=null)};return{start:function(n){return e()?r=window.setInterval((function(){try{t(n)}catch(n){o(),console.log(n)}}),1e3):null},stop:o}},W=function(){},X=function n(e){var t=e.window,r=e.bindings,o=e.callback,i=void 0===o?W:o,u=D();if(void 0===u)return i();if(!function(n){return n.some((function(n){return n.pageTest()}))}(r))return i();if(!function(n){var e=n.config,t=n.window,r=!0;return e.autocomplete&&(T(e),L(t)||(r=!1)),e.postcodeLookup&&(A(e),P(t)||(r=!1)),r}({config:u,window:t}))return setTimeout((function(){return n({window:t,bindings:r,callback:i})}),1e3);var c=r.reduce((function(n,e){var t=e.pageTest,r=e.bind;if(!t())return n;var o=V({pageTest:t,bind:r}),i=o.start,c=o.stop;return i(u),n.push({binding:e,start:i,stop:c}),n}),[]);return i(c)},Z=function(n){var e=n.selectors,t=n.anchorSelector,r=n.parentScope,o=n.doc,i=n.parentTest;return S(t||e.line_1,o).reduce((function(n,t){var o=E(t,r||"form",i);if(!o)return n;var u=function(n,e){var t=O(n,e.line_1);if(null===t)return null;var r=O(n,e.post_town);if(null===r)return null;var o=n.querySelector(e.postcode);if(null===o)return null;var i=O(n,e.line_2),u=O(n,e.line_3),c=O(n,e.country);return{line_1:t,line_2:i,line_3:u,post_town:r,county:O(n,e.county),postcode:o,organisation:O(n,e.organisation),country:c}}(o,e);return null===u||n.push({targets:u,parent:o,anchor:t}),n}),[])},z=function(n,e,t){if(!0===n.hoistCountry&&e.country&&e.line_1){var r=E(e.country,"div",(function(n){return n.classList.contains("field")}));if(r){var o=R(e,t);o&&k({elem:r,target:o})}}},R=function(n,e){var t=n.line_1;if(null===t)return null;var r=e?e.parentScope:"fieldset",o=e?e.parentTest:function(n){return n.classList.contains("field")};return E(t,r,o)},Y=["England","Scotland","Wales","Northern Ireland","Channel Islands","Isle of Man","United Kingdom","Jersey","Guernsey","GB","IM","JE","GG"],$=function(){},nn=function(n,e,t){var r=n.country;if(!r)return $;var o=function(){if(function(n){var e=n.value;return Y.reduce((function(n,t){return e===t||n}),!1)}(r))return e();t()};return r.addEventListener("change",o),o},en=function(n,e,t){if(!0===n.postcodeLookup){var r=function(n,e){var t=R(n,e);if(null===t)return null;var r=document.createElement("div");return r.className="idpc_lookup field",k({target:t,elem:r}),r}(e,t);if(null!==r)var o=window.jQuery(r).setupPostcodeLookup({api_key:n.apiKey,check_key:!0,onLoaded:function(){var n=function(n){var e=document.createElement("span");e.innerText="Search your Postcode";var t=document.createElement("label");return t.className="label",t.setAttribute("for","idpc_postcode_lookup"),t.appendChild(e),k({target:n,elem:t}),t}(r);nn(e,(function(){n.hidden=!1,o.show()}),(function(){n.hidden=!0,o.hide()}))()},onAddressSelected:U({config:n,targets:e})})}},tn=function(n,e){if(!0===n.autocomplete&&null!==e.line_1)var t=new window.IdealPostcodes.Autocomplete.Controller({api_key:n.apiKey,checkKey:!0,onLoaded:function(){nn(e,(function(){var n;(n=t).interface&&n.interface.initialiseEventListeners()}),(function(){return function(n){var e=n.interface;if(e){var t=e.input;e._onBlurBound(),t.removeEventListener("input",e._onInputBound),t.removeEventListener("blur",e._onBlurBound),t.removeEventListener("focus",e._onFocusBound),t.removeEventListener("keydown",e._onKeyDownBound),e.suggestionList.removeEventListener("mousedown",e._onMousedownBound)}}(t)}))()},inputField:e.line_1,onAddressRetrieved:U({config:n,targets:e})})},rn=function(n,e){return-1!==n.indexOf(e)},on={line_1:'[name="street[0]"]',line_2:'[name="street[1]"]',line_3:'[name="street[2]"]',postcode:'[name="postcode"]',post_town:'[name="city"]',organisation:'[name="company"]',county:'[name="region"]',country:'[name="country_id"]'},un={bind:function(n){Z({selectors:on,parentScope:"div",parentTest:function(n){return n.classList.contains("billing-address-form")}}).forEach((function(e){var t=e.targets;z(n,t),tn(n,t),en(n,t)}))},pageTest:function(){return rn(window.location.pathname,"/checkout")}},cn={bind:function(n){Z({selectors:on}).forEach((function(e){var t=e.targets;z(n,t),tn(n,t),en(n,t)}))},pageTest:function(){return rn(window.location.pathname,"/checkout")}},an={line_1:"#street_1",line_2:"#street_2",line_3:"#street_3",organisation:"#company",post_town:"#city",county:"#region",country:"#country",postcode:'[name="postcode"]'},ln={parentScope:"div",parentTest:function(n){return n.classList.contains("field")&&n.classList.contains("street")}},sn={bind:function(n){Z({selectors:an,parentTest:function(n){return"form-validate"===n.getAttribute("id")}}).forEach((function(e){var t=e.targets;z(n,t,ln),tn(n,t),en(n,t,ln)}))},pageTest:function(){return rn(window.location.pathname,"/multishipping")}},dn={bind:sn.bind,pageTest:function(){return rn(window.location.pathname,"/customer/address")}};window.idpcStart=function(){return X({bindings:[cn,un,dn,sn],window:window})}}();
